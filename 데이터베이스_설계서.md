# 데이터베이스 설계서 (v1.0)

본 문서는 백엔드 DB 구축을 위한 스키마 설계와 API 엔드포인트 정의를 포함합니다.

## 1. ERD (Entity Relationship Diagram) 구조

### 1.1 `users` (사용자)

| 필드명                 | 타입        | 제약조건                       | 설명                           |
| :--------------------- | :---------- | :----------------------------- | :----------------------------- |
| `id`                   | UUID        | PK, Default: gen_random_uuid() | 사용자 식별자                  |
| `name`                 | VARCHAR(50) | NOT NULL                       | 사용자 성명                    |
| `role`                 | VARCHAR(20) | NOT NULL                       | 'admin' 또는 'manager'         |
| `assigned_project_ids` | JSONB       |                                | 담당자가 맡은 프로젝트 ID 목록 |

### 1.2 `boards` (게시글)

| 필드명       | 타입         | 제약조건         | 설명                            |
| :----------- | :----------- | :--------------- | :------------------------------ |
| `id`         | UUID         | PK               | 게시글 식별자                   |
| `project_id` | UUID         | FK (projects.id) | 프로젝트 식별자                 |
| `author_id`  | UUID         | FK (users.id)    | 작성자 식별자                   |
| `status_id`  | VARCHAR(50)  | NOT NULL         | 상태 코드 (notice, progress 등) |
| `title`      | VARCHAR(255) | NOT NULL         | 게시글 제목                     |
| `content`    | TEXT         | NOT NULL         | 에디터 HTML/JSON 내용           |
| `view_count` | INTEGER      | Default: 0       | 조회수                          |
| `work_hours` | INTEGER      | Default: 0       | 작업공수 (관리자용)             |
| `is_secret`  | BOOLEAN      | Default: false   | 비밀글 여부                     |
| `created_at` | TIMESTAMP    | Default: NOW()   | 작성일시                        |

### 1.3 `comments` (댓글)

| 필드명        | 타입         | 제약조건       | 설명                   |
| :------------ | :----------- | :------------- | :--------------------- |
| `id`          | UUID         | PK             | 댓글 식별자            |
| `board_id`    | UUID         | FK (boards.id) | 대상 게시글            |
| `author_id`   | UUID         | FK (users.id)  | 작성자                 |
| `content`     | VARCHAR(200) | NOT NULL       | 댓글 내용 (최대 200자) |
| `is_internal` | BOOLEAN      | Default: false | 내부 메모 여부         |

## 2. SQL Schema 예시 (PostgreSQL)

```sql
CREATE TABLE boards (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    title VARCHAR(255) NOT NULL,
    content TEXT NOT NULL,
    status_id VARCHAR(50) NOT NULL,
    view_count INT DEFAULT 0,
    work_hours INT DEFAULT 0,
    is_secret BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    author_id UUID REFERENCES users(id)
);
```

## 3. 핵심 API 엔드포인트 제안

- `GET /api/boards`: 필터링 및 무한 스크롤 지원 (Query: `page`, `limit`, `search`, `projectId`)
- `POST /api/boards`: 신규 게시글 등록 (파일 업로드 포함)
- `PATCH /api/boards/:id/status`: 상태 변경 (관리자 권한 검증 필수)
- `POST /api/boards/:id/comments`: 댓글 및 내부 메모 등록

## 4. 변경 이력

| 날짜       | 버전 | 내용                            | 작성자       |
| :--------- | :--- | :------------------------------ | :----------- |
| 2026-01-04 | v1.0 | 초기 DB 스키마 및 API 구조 설계 | AI Assistant |
